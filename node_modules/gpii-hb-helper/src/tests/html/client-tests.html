<html>
    <head>
        <title>Browser-based Unit Tests for Handlebars Module</title>
        <!-- Bring in jQuery and other dependencies -->
        <script type="text/javascript" src="/modules/infusion/src/lib/jquery/core/js/jquery.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/lib/jquery/ui/js/jquery.ui.core.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/lib/json/js/json2.js"></script>

        <!-- Bring in fluid dependencies -->
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/FluidDocument.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/Fluid.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/FluidDOMUtilities.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/FluidIoC.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/DataBinding.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/FluidView.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/lib/fastXmlPull/js/fastXmlPull.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/renderer/js/fluidParser.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/renderer/js/fluidRenderer.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/FluidRequests.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/ModelTransformation.js"></script>
        <script type="text/javascript" src="/modules/infusion/src/framework/core/js/ModelTransformationTransforms.js"></script>
        
        <!-- Bring in Handlebars dependency -->
        <script type="text/javascript" src="/bc/handlebars/handlebars.js"></script>

        <!-- Bring in Pagedown dependencies -->
        <script type="text/javascript" src="/bc/pagedown/Markdown.Converter.js"></script>
        <script type="text/javascript" src="/bc/pagedown/Markdown.Sanitizer.js"></script>

        <!-- Bring in client library being tested -->
        <script type="text/javascript" src="/src/js/common/helpers.js"></script>
        <script type="text/javascript" src="/src/js/client/helpers-client.js"></script>

        <!-- Bring in our jqUnit dependencies -->
        <script type="text/javascript" src="/modules/infusion/tests/lib/qunit/js/qunit.js"></script>
        <script type="text/javascript" src="/modules/infusion/tests/test-core/jqUnit/js/jqUnit.js"></script>
        <script type="text/javascript" src="/modules/infusion/tests/test-core/jqUnit/js/jqUnit-browser.js"></script>

        <!-- Bring in our test helper -->
        <script type="text/javascript" src="/src/tests/js/client-tests.js"></script>
    </head>
    <body>
        <h1 id="qunit-header">Handlebars Helper Test Suite</h1>

        <p>This page needs to be served up by a server that can also deliver the required handlebars templates.  The tests should not complete in a standalone browser.</p>

        <hr/>

        <h2 id="qunit-banner"></h2>
        <div id="qunit-testrunner-toolbar"></div>
        <h2 id="qunit-userAgent"></h2>
        <ol id="qunit-tests"></ol>
        <div id="qunit-fixture">
            <!-- The markup we will be targeting -->

            <!-- Must come first so that we can tell that content has been inserted before it... -->
            <div class="viewport-before" style="display:none">original content</div>

            <div class="viewport-append" style="display:none">original content</div>

            <div class="viewport-prepend" style="display:none">original content</div>

            <div class="viewport-replaceWith" style="display:none">original content</div>

            <!-- Must come last so that we can tell that content has been inserted after it... -->
            <div class="viewport-after"  style="display:none">original content</div>
        </div>

        <script type="text/javascript">
            <!-- instantiate test component -->
            var tests = gpii.hb.clientTests("body");

            <!-- Fire up tests once the document has loaded -->
            $(document).ready(function() {
                tests.runTests();
            });
        </script>

        <!-- Add test templates -->
        <!-- TODO:  Set up a server that will provide the template content and remove this -->
        <script id="template-template" type="text/x-handlebars-template">
            <div class="rendered-content">
                <h1>Content from the template:</h1>
                <div>
                    {{{body}}}
                </div>
                <hr/>

                {{>partial}}
            </div>
        </script>

        <script id="template-replace" type="text/x-handlebars-template">
            <div class="viewport-replaceWith">
                <h1>Content from the template:</h1>
                <div>
                    {{{body}}}
                </div>
                <hr/>

                {{>partial}}
            </div>
        </script>

        <script id="partial-partial" type="text/x-handlebars-template">
            <h2>Content from the partial:</h2>

            <table>
                <thead>
                <tr>
                    <th>item</th><th>value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>model variable</td>
                    <td class="variable">{{myvar}}</td>
                </tr>
                <tr>
                    <td>jsonify</td>
                    <td class="jsonify">{{{jsonify json}}}</td>
                </tr>
                <tr>
                    <td>markdown</td>
                    <td class="markdown">{{{md markdown}}}</td>
                </tr>
                </tbody>
            </table>
        </script>
    </body>
</html>